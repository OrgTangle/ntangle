#+title: NTangle

/Command-line utility for Tangling of Org documents â€” programmed in
Nim./

* What is Tangling
From [[https://orgmode.org/manual/Extracting-source-code.html][Org Manual -- Extracting source code]]:

#+begin_quote
Extracting source code from code blocks is a basic task in /literate
programming/. Org has features to make this easy. In literate
programming parlance, documents on creation are /woven/ with code and
documentation, and on export, the code is *tangled* for execution by a
computer.

Org facilitates weaving and tangling for producing, maintaining,
sharing, and exporting literate programming documents. Org provides
extensive customization options for extracting source code.

When Org tangles ~src~ code blocks, it expands, merges, and transforms
them. Then Org recomposes them into one or more separate files, as
configured through the options. During this /tangling/ process, Org
expands variables in the source code, and resolves any Noweb style
references (see [[https://orgmode.org/manual/Noweb-reference-syntax.html][Noweb reference syntax]]).
#+end_quote

/You can visit the same Org manual section from within Emacs by going
to this Info manual node: ~(org) Extracting Source Code~./
* Why ~ntangle~?
While the tangling of Org documents works great from within Emacs, it
can be quite a bit slow for large Org documents. This project aims to
provide /almost/ the same tangling functionality at a much higher
speed.

You do *not* need Emacs or Org mode installed to use ~ntangle~.
* Installation
** Download binary
- 64-bit GNU/Linux type OS :: Head over to the [[https://github.com/OrgTangle/ntangle/releases][Releases]] section of this
     repo to download the release archive
     ~ntangle-VERSION.Linux_64bit_musl.tar.xz~. Then simply extract it
     to get the statically linked binary ~ntangle~ and run it.
- Other OSes :: The statically linked binary is available only for
                64-bit GNU/Linux type OS. Follow the [[#development][Development]]
                section below to build the binary locally for your OS.
** Build locally
See [[#development][Development]].
* Features
** Tangling /minus Noweb/ [7/8]
- [X] Understands global tangle header-args in ~#+property~ keywords
- [X] Understands tangle header-args directly above Org source blocks
- [-] Understands tangle subtree property drawer header-args
  - [X] Rudimentary parsing of the property drawer
    header-args. ~ntangle~ does not check the validity of the property
    drawer (i.e. ~:PROPERTIES:~ appears immediately after the heading,
    and it ends with ~:END:~, and that the properties are only between
    them, etc.). Also ~header-args~ is treated the same as
    ~header-args+~ for simplicity for now.
  - [ ] Treat ~header-args~ vs ~header-args+~ values correctly.
- [X] Understands the precendence order of the tangle header-args when
  a mix of global and source block header-args are used
- [X] Language-specific header-args (e.g. ~#+property: header-args:nim
  :tangle yes~)
- [X] Concatenating multiple source blocks to the same tangled file
- [X] Respects comma-escaping in source blocks
- [X] Removes common indentation, but also retains the indentation
  where needed
*** Supported ~header-args~ switches [5/7]
- [X] ~:tangle~
- [X] ~:padline~
- [X] ~:shebang~
- [X] ~:mkdirp~
- [X] ~:tangle-mode~
- [ ] ~:comments~
- [ ] ~:no-expand~
** Noweb [0/1]
- [ ] Noweb support. I sorely miss the lack of ~noweb~ support.. I use
  it heavily in [[https://github.com/kaushalmodi/eless][~eless~]].

/There is *no* plan to support Org Babel functions with Noweb, like
evaluating code blocks during tangling, etc. (just use Emacs for those
:D)./
*** Supported ~header-args~ switches for Noweb [0/3]
- [ ] ~:noweb~
- [ ] ~:noweb-ref~
- [ ] ~:noweb-sep~
* Screenshot
[[https://raw.githubusercontent.com/OrgTangle/ntangle/master/doc/img/Screenshot_ntangle_v0.4.2.png][https://raw.githubusercontent.com/OrgTangle/ntangle/master/doc/img/Screenshot_ntangle_v0.4.2.png]]
* Usage
Add one or more Org files (files with names ending in ".org") or
directory names after the ~ntangle~ command. If directory names are
added, only the files in there with names ending with ".org" will be
parsed.
#+begin_example
ntangle <FILE.org>
#+end_example

or a list of files:

#+begin_example
ntangle <FILE1.org> <FILE2.org> ..
#+end_example

or a list of directories:

#+begin_example
ntangle <DIR1> <DIR2> ..
#+end_example

or a mix of lists of files and directories:

#+begin_example
ntangle <FILE1.org> <DIR1> <FILE2.org> <DIR2> ..
#+end_example

The tangled files will be created in paths relative to the source Org
file.
* Org mode file samples for tangling
You can find samples of the supported Org mode tangling in the [[https://github.com/OrgTangle/ntangle/tree/master/tests][*test*
directory]] of this project.
* Development
** Building
[[https://github.com/nim-lang/nimble][~nimble~]] is used to build this project. This utility ships with Nim
installation. Think of it as the equivalent of ~pip~ in Python.

With Nim and ~nimble~ installed, do:
#+begin_example
git clone https://github.com/OrgTangle/ntangle
cd ntangle
nimble build -d:release # creates the ntangle binary in the same directory
#+end_example
** Installing
If you want to install it (i.e. build the binary and copy it to
=~/.nimble/bin/=), do:
#+begin_example
# cd to the git repo dir
nimble install
#+end_example

You need to add *~/.nimble/bin/* to your ~PATH~ environment variable.
** Testing
#+begin_src shell :results output verbatim
# cd to the git repo dir
./tests/test.sh
#+end_src
* History
The ~ntangle.nim~ file was written as an exercise to roughly translate the
Python script [[https://github.com/thblt/org-babel-tangle.py][~org-babel-tangle.py~]] (by @thblt) to Nim.
* Other Org tangling implementations
See [[https://github.com/OrgTangle]].
